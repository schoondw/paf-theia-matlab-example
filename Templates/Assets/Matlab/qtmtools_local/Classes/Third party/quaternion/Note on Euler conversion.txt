Bugs reported by Masachika Saito, 23 Jul 2019

	Notes EST:
	Issue could be related to misunderstanding of representation or sign.
	Fixing the code with suggestions below likely break consistency with the euler constructor.

	Same result can be obtained by calculating the negative of the inverse, e.g.:
	>> angles = -q.inverse().EulerAngles('xyz')
	instead of
	>> angles = q.EulerAngles('xyz');

	See also note on this in the quaternion help text.
	% Note:
	%  In all rotation operations, the rotations operate from left to right on
	%  3x1 column vectors and create rotated vectors, not representations of
	%  those vectors in rotated coordinate systems.
	%  For Euler angles, '123' means rotate the vector about x first, about y
	%  second, about z third, i.e.:
	%  vp = rotate(z,angle(3)) * rotate(y,angle(2)) * rotate(x,angle(1)) * v


I found some bugs and fixed as below. Please merge to your codes.
1298,1301c1298,1301
< case {'121', 'xyx', 'XYX', 'iji'}
< angles(1,iel) = atan2((q(iel).e(2).*q(iel).e(3)- ...
< q(iel).e(4).*q(iel).e(1)),(q(iel).e(2).*q(iel).e(4)+ ...
< q(iel).e(3).*q(iel).e(1)));
---
> case {'121', 'xyx', 'XYX', 'iji'} %fixed
> angles(1,iel) = atan2((q(iel).e(1).*q(iel).e(4)+ ...
> q(iel).e(2).*q(iel).e(3)),(q(iel).e(1).*q(iel).e(3)- ...
> q(iel).e(2).*q(iel).e(4)));
1304,1305c1304,1305
< angles(3,iel) = atan2((q(iel).e(2).*q(iel).e(3)+ ...
< q(iel).e(4).*q(iel).e(1)),(q(iel).e(3).*q(iel).e(1)- ...
---
> angles(3,iel) = atan2((q(iel).e(2).*q(iel).e(3)- ...
> q(iel).e(1).*q(iel).e(4)),(q(iel).e(1).*q(iel).e(3)+ ...
1307,1309c1307,1309
< case {'123', 'xyz', 'XYZ', 'ijk'}
< angles(1,iel) = atan2(2.*(q(iel).e(2).*q(iel).e(1)+ ...
< q(iel).e(4).*q(iel).e(3)),(q(iel).e(1).^2- ...
---
> case {'123', 'xyz', 'XYZ', 'ijk'} %fixed
> angles(1,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(2)- ...
> q(iel).e(3).*q(iel).e(4)),(q(iel).e(1).^2- ...
1311c1311
< angles(2,iel) = asin(2.*(q(iel).e(3).*q(iel).e(1)- ...
---
> angles(2,iel) = asin(2.*(q(iel).e(1).*q(iel).e(3)+ ...
1313,1314c1313,1314
< angles(3,iel) = atan2(2.*(q(iel).e(2).*q(iel).e(3)+ ...
< q(iel).e(4).*q(iel).e(1)),(q(iel).e(1).^2+ ...
---
> angles(3,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(4)- ...
> q(iel).e(2).*q(iel).e(3)),(q(iel).e(1).^2+ ...
1316,1318c1316,1318
< case {'131', 'xzx', 'XZX', 'iki'}
< angles(1,iel) = atan2((q(iel).e(2).*q(iel).e(4)+ ...
< q(iel).e(3).*q(iel).e(1)),(q(iel).e(4).*q(iel).e(1)- ...
---
> case {'131', 'xzx', 'XZX', 'iki'} %fixed
> angles(1,iel) = atan2((q(iel).e(2).*q(iel).e(4)- ...
> q(iel).e(1).*q(iel).e(3)),(q(iel).e(1).*q(iel).e(4)+ ...
1322,1327c1322,1327
< angles(3,iel) = atan2((q(iel).e(2).*q(iel).e(4)- ...
< q(iel).e(3).*q(iel).e(1)),(q(iel).e(2).*q(iel).e(3)+ ...
< q(iel).e(4).*q(iel).e(1)));
< case {'132', 'xzy', 'XZY', 'ikj'}
< angles(1,iel) = atan2(2.*(q(iel).e(2).*q(iel).e(1)- ...
< q(iel).e(4).*q(iel).e(3)),(q(iel).e(1).^2- ...
---
> angles(3,iel) = atan2((q(iel).e(1).*q(iel).e(3)+ ...
> q(iel).e(2).*q(iel).e(4)),(q(iel).e(1).*q(iel).e(4)- ...
> q(iel).e(2).*q(iel).e(3)));
> case {'132', 'xzy', 'XZY', 'ikj'} %fixed
> angles(1,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(2)+ ...
> q(iel).e(3).*q(iel).e(4)),(q(iel).e(1).^2- ...
1329,1331c1329,1331
< angles(2,iel) = asin(2.*(q(iel).e(2).*q(iel).e(3)+ ...
< q(iel).e(4).*q(iel).e(1)));
< angles(3,iel) = atan2(2.*(q(iel).e(3).*q(iel).e(1)- ...
---
> angles(2,iel) = asin(2.*(q(iel).e(1).*q(iel).e(4)- ...
> q(iel).e(2).*q(iel).e(3)));
> angles(3,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(3)+ ...
1334,1336c1334,1336
< case {'212', 'yxy', 'YXY', 'jij'}
< angles(1,iel) = atan2((q(iel).e(2).*q(iel).e(3)+ ...
< q(iel).e(4).*q(iel).e(1)),(q(iel).e(2).*q(iel).e(1)- ...
---
> case {'212', 'yxy', 'YXY', 'jij'} %fixed
> angles(1,iel) = atan2((q(iel).e(2).*q(iel).e(3)- ...
> q(iel).e(1).*q(iel).e(4)),(q(iel).e(1).*q(iel).e(2)+ ...
1340,1341c1340,1341
< angles(3,iel) = atan2((q(iel).e(2).*q(iel).e(3)- ...
< q(iel).e(4).*q(iel).e(1)),(q(iel).e(2).*q(iel).e(1)+ ...
---
> angles(3,iel) = atan2((q(iel).e(1).*q(iel).e(4)+ ...
> q(iel).e(2).*q(iel).e(3)),(q(iel).e(1).*q(iel).e(2)- ...
1343,1345c1343,1345
< case {'213', 'yxz', 'YXZ', 'jik'}
< angles(1,iel) = atan2(2.*(q(iel).e(3).*q(iel).e(1)- ...
< q(iel).e(4).*q(iel).e(2)),(q(iel).e(1).^2- ...
---
> case {'213', 'yxz', 'YXZ', 'jik'} %fixed
> angles(1,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(3)+ ...
> q(iel).e(2).*q(iel).e(4)),(q(iel).e(1).^2- ...
1347c1347
< angles(2,iel) = asin(2.*(q(iel).e(2).*q(iel).e(1)+ ...
---
> angles(2,iel) = asin(2.*(q(iel).e(1).*q(iel).e(2)- ...
1349c1349
< angles(3,iel) = atan2(2.*(q(iel).e(4).*q(iel).e(1)- ...
---
> angles(3,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(4)+ ...
1352,1354c1352,1354
< case {'231', 'yzx', 'YZX', 'jki'}
< angles(1,iel) = atan2(2.*(q(iel).e(2).*q(iel).e(4)+ ...
< q(iel).e(3).*q(iel).e(1)),(q(iel).e(1).^2+ ...
---
> case {'231', 'yzx', 'YZX', 'jki'} %fixed
> angles(1,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(3)- ...
> q(iel).e(2).*q(iel).e(4)),(q(iel).e(1).^2+ ...
1356c1356
< angles(2,iel) = asin(2.*(q(iel).e(4).*q(iel).e(1)- ...
---
> angles(2,iel) = asin(2.*(q(iel).e(1).*q(iel).e(4)+ ...
1358c1358
< angles(3,iel) = atan2(2.*(q(iel).e(2).*q(iel).e(1)+ ...
---
> angles(3,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(2)- ...
1361,1364c1361,1364
< case {'232', 'yzy', 'YZY', 'jkj'}
< angles(1,iel) = atan2((q(iel).e(3).*q(iel).e(4)- ...
< q(iel).e(2).*q(iel).e(1)),(q(iel).e(2).*q(iel).e(3)+ ...
< q(iel).e(4).*q(iel).e(1)));
---
> case {'232', 'yzy', 'YZY', 'jkj'} %fixed
> angles(1,iel) = atan2((q(iel).e(1).*q(iel).e(2)+ ...
> q(iel).e(3).*q(iel).e(4)),(q(iel).e(1).*q(iel).e(4)- ...
> q(iel).e(2).*q(iel).e(3)));
1367,1368c1367,1368
< angles(3,iel) = atan2((q(iel).e(2).*q(iel).e(1)+ ...
< q(iel).e(3).*q(iel).e(4)),(q(iel).e(4).*q(iel).e(1)- ...
---
> angles(3,iel) = atan2((q(iel).e(3).*q(iel).e(4)- ...
> q(iel).e(1).*q(iel).e(2)),(q(iel).e(1).*q(iel).e(4)+ ...
1370,1372c1370,1372
< case {'312', 'zxy', 'ZXY', 'kij'}
< angles(1,iel) = atan2(2.*(q(iel).e(2).*q(iel).e(3)+ ...
< q(iel).e(4).*q(iel).e(1)),(q(iel).e(1).^2- ...
---
> case {'312', 'zxy', 'ZXY', 'kij'} %fixed
> angles(1,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(4)- ...
> q(iel).e(2).*q(iel).e(3)),(q(iel).e(1).^2- ...
1374c1374
< angles(2,iel) = asin(2.*(q(iel).e(2).*q(iel).e(1)- ...
---
> angles(2,iel) = asin(2.*(q(iel).e(1).*q(iel).e(2)+ ...
1376,1377c1376,1377
< angles(3,iel) = atan2(2.*(q(iel).e(2).*q(iel).e(4)+ ...
< q(iel).e(3).*q(iel).e(1)),(q(iel).e(1).^2- ...
---
> angles(3,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(3)- ...
> q(iel).e(2).*q(iel).e(4)),(q(iel).e(1).^2- ...
1379,1381c1379,1381
< case {'313', 'zxz', 'ZXZ', 'kik'}
< angles(1,iel) = atan2((q(iel).e(2).*q(iel).e(4)- ...
< q(iel).e(3).*q(iel).e(1)),(q(iel).e(2).*q(iel).e(1)+ ...
---
> case {'313', 'zxz', 'ZXZ', 'kik'} %fixed
> angles(1,iel) = atan2((q(iel).e(1).*q(iel).e(3)+ ...
> q(iel).e(2).*q(iel).e(4)),(q(iel).e(1).*q(iel).e(2)- ...
1385,1386c1385,1386
< angles(3,iel) = atan2((q(iel).e(2).*q(iel).e(4)+ ...
< q(iel).e(3).*q(iel).e(1)),(q(iel).e(2).*q(iel).e(1)- ...
---
> angles(3,iel) = atan2((q(iel).e(2).*q(iel).e(4)- ...
> q(iel).e(1).*q(iel).e(3)),(q(iel).e(1).*q(iel).e(2)+ ...
1388,1389c1388,1389
< case {'321', 'zyx', 'ZYX', 'kji'}
< angles(1,iel) = atan2(2.*(q(iel).e(4).*q(iel).e(1)- ...
---
> case {'321', 'zyx', 'ZYX', 'kji'} %fixed
> angles(1,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(4)+ ...
1392,1394c1392,1394
< angles(2,iel) = asin(2.*(q(iel).e(2).*q(iel).e(4)+ ...
< q(iel).e(3).*q(iel).e(1)));
< angles(3,iel) = atan2(2.*(q(iel).e(2).*q(iel).e(1)- ...
---
> angles(2,iel) = asin(2.*(q(iel).e(1).*q(iel).e(3)- ...
> q(iel).e(2).*q(iel).e(4)));
> angles(3,iel) = atan2(2.*(q(iel).e(1).*q(iel).e(2)+ ...
1397,1399c1397,1399
< case {'323', 'zyz', 'ZYZ', 'kjk'}
< angles(1,iel) = atan2((q(iel).e(2).*q(iel).e(1)+ ...
< q(iel).e(3).*q(iel).e(4)),(q(iel).e(3).*q(iel).e(1)- ...
---
> case {'323', 'zyz', 'ZYZ', 'kjk'} %fixed
> angles(1,iel) = atan2((q(iel).e(3).*q(iel).e(4)- ...
> q(iel).e(1).*q(iel).e(2)),(q(iel).e(1).*q(iel).e(3)+ ...
1403,1405c1403,1405
< angles(3,iel) = atan2((q(iel).e(3).*q(iel).e(4)- ...
< q(iel).e(2).*q(iel).e(1)),(q(iel).e(2).*q(iel).e(4)+ ...
< q(iel).e(3).*q(iel).e(1)));
---
> angles(3,iel) = atan2((q(iel).e(1).*q(iel).e(2)+ ...
> q(iel).e(3).*q(iel).e(4)),(q(iel).e(1).*q(iel).e(3)- ...
> q(iel).e(2).*q(iel).e(4)));
2419c2419
< qout = product( q0(i0), qout );
---
> qout = product( qout, q0(i0) ); %fixed
            
